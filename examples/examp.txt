<b>Подробное описание пунктов чек-листа разработчика</b>
http://wiki.amocrm.ru/pages/viewpage.action?pageId=14058671

<b>1. Убраны все дебаги, console.log и т.д.</b>
да
<b>2. Изменялись таски сборки фронта</b>
нет
<b>3. Добавились новые пакеты в package.json</b>
нет
<b>4. Добавились новые вендорные библиотеки</b>
нет
<b>5. Добавились новые папки шаблонов в папке /api/v2/application/views/twig/interface/</b>
нет
<b>6. Рассылка: нужна / нет</b>
нет
<b>7. Необходимые изменение боевого окружения (БД, воркеры, nginx и т.п.)</b>
нет
<b>8. Производительность (обязательно, если добавляли/изменялись выборки данных или задача по backend заняла более 40 часов)</b>
нет
<b>9. Обработка ошибок: если изменилась, то описать возможные ошибки</b>
нет
<b>10. Code Style</b>
да
<b>a. PHPDoc у классов, методов и скриптов:</b>
ок
<b>b. Строгое сравнение строк (===):</b>
да
<b>c. Максимальная длина строки 120 сим.:</b>
да
<b>11. Тестирование перед отгрузкой</b>
да
<b>12. Дублирование кода – зло!</b>
да
<b>13. Не вешайте все на bitrix prolog. Если повесили – описать</b>
нет
<b>14. Сданная ветка – неприкасаема</b>
да
<b>15. REQUEST/GET/POST – использовались или нет</b>
нет
<b>16. Текстовые сообщения</b>
нет
<b>17. Права: есть ли проверка прав?</b>
нет
<b>18. Авторизация и ключи</b>
нет
<b>19. Правки взятые за одно</b>
нет
<b>20. Merge с основной веткой</b>
да
<b>21. Объем изменений</b>
бэк - 1 файл
<b>22. Описание отгрузки</b>

<b><i>a. Ветка</i></b>
hotfix/wbs_42794_2
<b><i>b. Merge request</i></b>
https://git.amocrm.ru/amocrm/core/merge_requests/3897
<b><i>c. Какой сервис</i></b>
account
<b><i>d. В какую ветку</i></b>
master_v6
<b><i>e. Проверка правок для второй версии сервиса</i></b>

---------------------------------------------------------
200

<b>ОСНОВНЫЕ КЕЙСЫ ПО КОТОРЫМ ПРОИЗВОДИЛОСЬ ТЕСТИРОВАНИЕ</b>
Это цепочки, включающие в себя все интерфейсы, затронутые новым функционалом. Необходимо пройти по всем кейсам: настройки функционала, добавление информации, вывод. Обычно такие кейсы, они же прецеденты, описываются в ТЗ.

Кейсы на хостах:
- Проставление заказу статуса "Оплачен в аванс" в /_support.
- Проставление заказу статуса "Оплачен в аванс" в /bitrix/admin
- Проставление счету статуса "Оплачен в аванс" в /partners/private/shop/list/
Во всех кейсах сделка должна перейти в этап "оплачен в аванс". В карточке должно быть системное примечание об оплате в аванс, флаг "оплачен в аванс" не должен быть установлен.
Кейсы на стейдже:
- Проставление заказу статуса "Оплачен в аванс" в /_support.
- Проставление заказу статуса "Оплачен в аванс" в /bitrix/admin
- Проставление счету статуса "Оплачен в аванс" в /partners/private/shop/list/
Во всех кейсах сделка должна перейти в этап "оплачен в аванс". В карточке должно быть системное примечание об оплате в аванс, флаг "оплачен в аванс" не должен быть установлен.
Кейсы на проде:
- Проставление заказу статуса "Оплачен в аванс" в /_support.
- Проставление заказу статуса "Оплачен в аванс" в /bitrix/admin
- Проставление счету статуса "Оплачен в аванс" в /partners/private/shop/list/
Во всех кейсах сделка должна перейти в этап "оплачен в аванс". В карточке должно быть системное примечание об оплате в аванс, флаг "оплачен в аванс" не должен быть установлен.

<b>Тестирование основных цепочек на хостах</b> (http://wiki.amocrm.ru/pages/viewpage.action?pageId=14483518)
Проверенные разделы:

Затрагивает ли новый функционал API и прямо или косвенно мобильные устройства. Если да, то как протестировано? Изменились ли автотесты?
Кейсы для API:

1. Браузеры
Тестирование IE10+, EDGE, FF, Chrome, Safari (на тестовом Mac в офисе), iPad (тестовый в офисе)
Результат:

2. Тексты и Язык
Весь текст в новом функционале, должен быть конечным, согласованным и понятным. Весь перевод текста в новом функционале так же должен быть согласованным. Любой новый функционал должен быть проверен на английском языке и на испанском. При тестировании функционала переключать не только язык, но и формат времени/даты
Результат:

3. Прокликать все элементы всех экранных форм, убедиться, что все кнопки, ссылки и весь функционал на странице работает корректно
Результат:
4. Изменить размер окна до минимального (вертикальное положение iPad), проверить, что все работает корректно
Результат:


5. При добавлении любой информации проверять на добавление спец. символов (кавычки, точки, одинарные кавычки, проценты и т.д.), ввести <SCRIPT>alert(1)</SCRIPT> Если выводится после обновления табличка, значит возврат
Результат:


6. Все кейсы обязательно должны быть проверены под разными правами, ограниченными особенно. Т.е. у вас в аккаунте должно быть 3 пользователя с разными правами, можно авторизоваться ими отдельно в разным браузерах при тестировании, так удобнее, как будто одновременно работают несколько человек
Результат:

7. Смотрим, что не сбиваются часовые пояса в новом функционале. Т.е. вы добавляете примечание, к примеру, в 13:00 и во всех местах выводится именно 13:00.
Результат:

----------------------------------------------
172
ветка
--------------------------------------------

X-team
стейдж
сервера
бой
-----------------------------------------------------------------------
Кейсы на стейдже:
- Проставление заказу статуса "Оплачен в аванс" в /_support.
- Проставление заказу статуса "Оплачен в аванс" в /bitrix/admin
- Проставление счету статуса "Оплачен в аванс" в /partners/private/shop/list/
Кейсы проверены. Все отрабатывает
----------------------------------------------------------------------



Подробное описание пунктов чек-листа разработчика
http://wiki.amocrm.ru/pages/viewpage.action?pageId=14058671

1. Убраны все дебаги, console.log и т.д.
да
2. Изменялись таски сборки фронта
нет
3. Добавились новые пакеты в package.json
нет
4. Добавились новые вендорные библиотеки
нет
5. Добавились новые папки шаблонов в папке /api/v2/application/views/twig/interface/
нет
6. Рассылка: нужна / нет
нет
7. Необходимые изменение боевого окружения (БД, воркеры, nginx и т.п.)
СКРИПТЫ:
- app/cli/scripts/single/set_user_id_field/prepare_updates.php
- app/cli/scripts/single/set_user_id_field/make_updates.php
ЗАПУСК:
  1. удалить из папки /tmp файлы:
    - uid-update-data.txt
    - uid-willnot-update.json
    - uid-errors.json
    - uid-error-request.json
  2. запустить первый скрипт:
    php app/cli/scripts/single/set_user_id_field/prepare_updates.php -d=/tmp
  3. запустить второй скрипт
    php app/cli/scripts/single/set_user_id_field/make_updates.php -d=/tmp -f=1235547

8. Производительность (обязательно, если добавляли/изменялись выборки данных или задача по backend заняла более 40 часов)
нет
9. Обработка ошибок: если изменилась, то описать возможные ошибки
нет
10. Code Style
да
a. PHPDoc у классов, методов и скриптов:
ок
b. Строгое сравнение строк (===):
нет
c. Максимальная длина строки 120 сим.:
да
11. Тестирование перед отгрузкой
нет
12. Дублирование кода – зло!
да
13. Не вешайте все на bitrix prolog. Если повесили – описать
нет
14. Сданная ветка – неприкасаема
да
15. REQUEST/GET/POST – использовались или нет
нет
16. Текстовые сообщения
нет
17. Права: есть ли проверка прав?
нет
18. Авторизация и ключи
нет
19. Правки взятые за одно
нет
20. Merge с основной веткой
да
21. Объем изменений
бэк - 2 файл
22. Описание отгрузки

a. Ветка
hotfix/45480
b. Merge request
https://git.amocrm.ru/amocrm/core/merge_requests/4453
c. Какой сервис
account
d. В какую ветку
master_v6
e. Проверка правок для второй версии сервиса



ОСНОВНЫЕ КЕЙСЫ ПО КОТОРЫМ ПРОИЗВОДИЛОСЬ ТЕСТИРОВАНИЕ
Это цепочки, включающие в себя все интерфейсы, затронутые новым функционалом. Необходимо пройти по всем кейсам: настройки функционала, добавление информации, вывод. Обычно такие кейсы, они же прецеденты, описываются в ТЗ.

Кейсы на хостах:
- результат запуска первого скрипта (app/cli/scripts/single/set_account_id_field/prepare-updates.php) - создание 2 файлов в директории, переданной в параметр -d при запуске:
    update-data.txt
    willnot-update.json
- результат запуска второго скрипта (app/cli/scripts/single/set_account_id_field/make-updates.php) при наличии ошибок запросов апдейта и неудачных апдейтов - создание файлов:
    errors.json
    error-request.json
и проставление кастомного поля, переданного в параметре -f (id поля) в карточке сделок (для всех update-data.txt)

Кейсы на стейдже:
Кейсы на хостах:
- результат запуска первого скрипта (app/cli/scripts/single/set_account_id_field/prepare-updates.php) - создание 2 файлов в директории, переданной в параметр -d при запуске:
    update-data.txt
    willnot-update.json
- результат запуска второго скрипта (app/cli/scripts/single/set_account_id_field/make-updates.php) при наличии ошибок запросов апдейта и неудачных апдейтов - создание файлов:
    errors.json
    error-request.json
и проставление кастомного поля, переданного в параметре -f (id поля) в карточке сделок (для всех update-data.txt)

Кейсы на проде:
Кейсы на хостах:
- результат запуска первого скрипта (app/cli/scripts/single/set_account_id_field/prepare-updates.php) - создание 2 файлов в директории, переданной в параметр -d при запуске:
    update-data.txt
    willnot-update.json
- результат запуска второго скрипта (app/cli/scripts/single/set_account_id_field/make-updates.php) при наличии ошибок запросов апдейта и неудачных апдейтов - создание файлов:
    errors.json
    error-request.json
и проставление кастомного поля, переданного в параметре -f (id поля) в карточке сделок (для всех update-data.txt)

if ($data['action'] === self::ACTION_USER_ADD) {
                $data['action'] = self::QUEUE_FULL_SYNC_NAME;
                $data['data'] = [];
                $data['data'] = [
                    [
                        'id' => 958030,
                        'email' => 'amolyakov@team.amocrm.com',
                        'work_phone' => '8324532452',
                        'mobile_phone' => '89023489583245',
                        'accounts' => [
                            17022838 => [
                                'need_create' => true,
                                'date_create' => time() - 100,
                                'pay_type' => '',
                            ],
                        ],
                        'name' => 'Tolyan',
                        'date_register' => time() - 1000,
                    ],
                ];
                $this->startSync($data, CustomerUpdateTool::AMO_SHARD_TYPE_COM);
            }die();
